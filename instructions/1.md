Hello Copilot. I need you to implement a complete Admin Panel and License Key activation system for my Next.js project.

Please use `@workspace` to scan the existing project structure (Next.js App Router, Prisma, NextAuth.js, Tailwind CSS).

Here is the full plan. Please provide the code for each step.

---

### Task 1: Update the Database Schema (`prisma/schema.prisma`)

First, I need to modify the `schema.prisma` file to support user roles and license keys.

1.  **Add a `Role` Enum:**
    ```prisma
    enum Role {
      USER
      ADMIN
    }
    ```

2.  **Update the `User` Model:**
    * Add a `role` field that defaults to `USER`.
    * Add an `isActivated` boolean field that defaults to `false`.
    * Add a one-to-one relation to the `LicenseKey` model (to see which key they used).

3.  **Create a new `LicenseKey` Model:**
    * This table will store the generated keys.
    * The `id` (the key itself) will be a `String`.
    * It must track if the key `isUsed` (boolean, default `false`).
    * It must have a one-to-one relation to the `User` who activated it. This relation field (`activatedByUserId`) must be `@unique`.

Here is the target schema. Please generate/confirm this:

```prisma
// (Keep existing models like Account, Session...)

model User {
  id            String    @id @default(cuid())
  name          String?
  email         String?   @unique
  emailVerified DateTime?
  image         String?
  accounts      Account[]
  sessions      Session[]

  // --- ADD THESE FIELDS ---
  role          Role      @default(USER)
  isActivated   Boolean   @default(false)
  
  // Relation to the key they used
  activatedKey  LicenseKey?
}

model LicenseKey {
  id        String   @id // We will provide the custom 'TAK-...' string
  createdAt DateTime @default(now())
  isUsed    Boolean  @default(false)
  
  // Relation to the user who activated this key
  activatedByUserId String?  @unique
  activatedByUser   User?    @relation(fields: [activatedByUserId], references: [id])
}

enum Role {
  USER
  ADMIN
}

After this, I will manually run npx prisma migrate dev --name init_licensing to apply this.

Task 2: Update NextAuth.js Configuration (e.g., lib/auth.ts)

My NextAuth.js session object needs to know about role and isActivated. Please modify the callbacks in my authOptions file (lib/auth.ts or wherever it is).

    session callback: Update this callback to add id, role, and isActivated from the user (or token) object to the session.user object.

    jwt callback: (If using JWT strategy) Ensure role and isActivated are added to the token.

The session.user type should be extended to include: id: string role: Role isActivated: boolean

Task 3: Create the Admin Panel (app/admin/page.tsx and app/admin/actions.ts)

This page must be protected and only accessible to ADMIN users.

1. Create the Admin Page (app/admin/page.tsx):

    Use import { auth } from "@/lib/auth"; (or the correct path) to get the session.

    Security: Check the session. If session?.user?.role !== 'ADMIN', immediately redirect('/').

    UI:

        Show a "Generate New License Key" button (we will create this as a form).

        Fetch all existing keys: const keys = await prisma.licenseKey.findMany(...).

        Display these keys in a table (show id, isUsed, createdAt).

2. Create the Key Generation Action (app/admin/actions.ts):

    Create a new file for Server Actions at app/admin/actions.ts.

    Create a function async function createLicenseKey().

    Security: Inside this action, re-check that the user is an ADMIN using auth().

    Logic:

        Import crypto from node:crypto.

        Generate a unique code: const uniqueCode = \TAK-${crypto.randomUUID().split('-')[0].toUpperCase()}``

        Create the key in the database: await prisma.licenseKey.create({ data: { id: uniqueCode } })

        Call revalidatePath('/admin') to refresh the table on the admin page.

3. Wire up the button on app/admin/page.tsx:

    Make the "Generate" button a <form> that calls the createLicenseKey server action.

Task 4: Create the User Activation System (app/dashboard/page.tsx and app/dashboard/actions.ts)

This is the main dashboard that users see after logging in. It must show different content based on their isActivated status.

1. Create the Conditional Page (app/dashboard/page.tsx):

    Get the session using auth().

    Conditional Rendering:

        IF session.user.isActivated === false:

            Show a simple form (Turkish): "Hesabınızı Aktifleştirin".

            Show one text input field (name="licenseKey") for the "Aktivasyon Kodu".

            Show a submit button (Turkish): "Aktifleştir".

            This form should call the activateAccount server action.

        IF session.user.isActivated === true:

            Show the main application UI (Turkish): "Hoş geldiniz! Lütfen uygulama grubunuzu seçin (A, B, C...)" (You can just add a placeholder <h1> for this for now).

2. Create the Activation Action (app/dashboard/actions.ts):

    Create a new file app/dashboard/actions.ts.

    Create a function async function activateAccount(formData: FormData).

    Security: Get the session using auth() and get the userId.

    Logic:

        Get the licenseKey from formData.get('licenseKey').

        Find the key: const key = await prisma.licenseKey.findUnique({ where: { id: licenseKey } }).

        Validate: Check if !key or key.isUsed. If so, return { error: "Geçersiz veya kullanılmış kod." }.

        Activate (in a Transaction):

            Use prisma.$transaction to update both tables.

            Update the User: prisma.user.update({ where: { id: userId }, data: { isActivated: true } })

            Update the LicenseKey: prisma.licenseKey.update({ where: { id: licenseKey }, data: { isUsed: true, activatedByUserId: userId } })

        Call revalidatePath('/dashboard') to refresh the page.

Please provide the code for all new and modified files.